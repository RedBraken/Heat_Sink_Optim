lb = [0.04,0.0008,0.02286,0.001,10,0.1,2];
ub = [0.07,0.002,0.04,0.004,25,0.203,4];
function fun = objective(x)
rho = 1.225;
mu = 1.79*10^(-5);
tb = 0.00254;
ks = 167;
kf = 0.0242;
Pr = 0.7444;
rho_al = 2719;
fun(1) = ((0.5*rho*x(7)*x(7)))*((0.42*(1-((x(5)-1)*x(4)*x(3)/((x(5)*x(2)+(x(5)-1)*x(4))*(x(3)+tb)))))+(1-((x(5)-1)*x(4)*x(3)/((x(5)*x(2)+(x(5)-1)*x(4))*(x(3)+tb))))^2+(4*x(6)*mu/(rho*x(7)*(4*x(4)*x(3)/(2*(x(4)+x(3))))^2))*(((3.44/(x(6)*mu/(rho*x(7)*(4*x(4)*x(3)/(2*(x(4)+x(3))))^2))^0.5)^2)+(24*(1-1.3553*(x(4)/x(3))+1.9467*(x(4)/x(3))^2-1.7012*(x(4)/x(3))^3+0.9564*(x(4)/x(3))^4-0.2537*(x(4)/x(3))^5))^2)^0.5);
fun(2) = -(kf/x(4))*(tanh(((2*((1/((rho*x(7)*x(4)*x(4))/(mu*x(6))*Pr*0.5)^3)+(1/(0.664*((rho*x(7)*x(4)*x(4))/(mu*x(6)))^0.5*Pr^(1/3)*(1+(3.65/((rho*x(7)*x(4)*x(4))/(mu*x(6)))^0.5))^0.5))^3)^(-1/3)*kf*x(3)^2)/(ks*x(4)*x(2))*((x(2)/x(6))+1))^0.5)/(((2*((1/((rho*x(7)*x(4)*x(4))/(mu*x(6))*Pr*0.5)^3)+(1/(0.664*((rho*x(7)*x(4)*x(4))/(mu*x(6)))^0.5*Pr^(1/3)*(1+(3.65/((rho*x(7)*x(4)*x(4))/(mu*x(6)))^0.5))^0.5))^3)^(-1/3)*kf*x(3)^2)/(ks*x(4)*x(2))*((x(2)/x(6))+1))^0.5))*((1/((rho*x(7)*x(4)*x(4))/(mu*x(6))*Pr*0.5)^3)+(1/(0.664*((rho*x(7)*x(4)*x(4))/(mu*x(6)))^0.5*Pr^(1/3)*(1+(3.65/((rho*x(7)*x(4)*x(4))/(mu*x(6)))^0.5))^0.5))^3)^(-1/3);
fun(3) = ((((x(2)*x(5)+(x(5)-1))*x(4))*tb*x(6))+(x(2)*x(6)*x(3))*x(5));
end
function [c,ceq] = constraints(x)
rho = 1.225;
mu = 1.79*10^(-5);
tb = 0.00254;
ks = 167;
kf = 0.0242;
Pr = 0.7444;
rho_al = 2719;
c = [x(5)*x(2)+(x(5)-1)*x(4)-x(1); (rho*x(7)*(4*x(4)*x(3)/(2*(x(4)+x(3))))/mu)-2300; x(3)-(x(5)*x(2)+(x(5)-1)*x(4)); -((0.5*rho*x(7)*x(7)))*((0.42*(1-((x(5)-1)*x(4)*x(3)/((x(5)*x(2)+(x(5)-1)*x(4))*(x(3)+tb)))))+(1-((x(5)-1)*x(4)*x(3)/((x(5)*x(2)+(x(5)-1)*x(4))*(x(3)+tb))))^2+(4*x(6)*mu/(rho*x(7)*(4*x(4)*x(3)/(2*(x(4)+x(3))))^2))*(((3.44/(x(6)*mu/(rho*x(7)*(4*x(4)*x(3)/(2*(x(4)+x(3))))^2))^0.5)^2)+(24*(1-1.3553*(x(4)/x(3))+1.9467*(x(4)/x(3))^2-1.7012*(x(4)/x(3))^3+0.9564*(x(4)/x(3))^4-0.2537*(x(4)/x(3))^5))^2)^0.5)+20;-((0.5*rho*x(7)*x(7)))*((0.42*(1-((x(5)-1)*x(4)*x(3)/((x(5)*x(2)+(x(5)-1)*x(4))*(x(3)+tb)))))+(1-((x(5)-1)*x(4)*x(3)/((x(5)*x(2)+(x(5)-1)*x(4))*(x(3)+tb))))^2+(4*x(6)*mu/(rho*x(7)*(4*x(4)*x(3)/(2*(x(4)+x(3))))^2))*(((3.44/(x(6)*mu/(rho*x(7)*(4*x(4)*x(3)/(2*(x(4)+x(3))))^2))^0.5)^2)+(24*(1-1.3553*(x(4)/x(3))+1.9467*(x(4)/x(3))^2-1.7012*(x(4)/x(3))^3+0.9564*(x(4)/x(3))^4-0.2537*(x(4)/x(3))^5))^2)^0.5)+40];
ceq = [];
end
intcon = 5;
a = [];
b = [];
n = 7;
options = optimoptions('gamultiobj','PopulationSize',200,'CrossoverFraction',0.8,'PlotFcn',{@gaplotpareto,@gaplotscorediversity});
[x,fval] = gamultiobj(@objective,n,[],[],[],[],lb,ub,@constraints,intcon,options);
disp("Pareto");
disp(x);
disp("Objective values at solutions");
disp(fval);
[r,i] = max((-fval(:,2)./fval(:,1)));
p = fval(:,1);
p = p(p>=10);
h = -fval(:,2);
h = h(h>=20);
X = linspace(1,70,70);
%[ax,h1,h2] = plotyy(x,(-fval(:,2)./fval(:,1)),x,fval(:,2));

